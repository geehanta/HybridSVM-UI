<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cancer Scan Predictor</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        .rating-buttons {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
        }
        .rating-buttons button {
            min-width: 150px;
            font-size: 1.2rem;
        }
    </style>
</head>
<body class="bg-light">
<div class="container mt-5">
    <h2 class="mb-4 text-center">Cancer Scan Image Classifier</h2>

    <form method="POST" enctype="multipart/form-data" class="card p-4 shadow">
        <div class="mb-3">
            <label for="image" class="form-label">Upload Cancer Scan</label>
            <input class="form-control" type="file" name="image" id="image" required>
        </div>
        <button class="btn btn-primary" type="submit">Predict</button>
    </form>

    {% if uploaded %}
        <div class="alert alert-info mt-4 text-center">
            <strong>Prediction:</strong> {{ prediction }}
        </div>

        <div class="card p-4 shadow mt-3 text-center">
            <label class="form-label mb-3">Rate this prediction</label>
            <div class="rating-buttons mb-3">
                <button class="btn " onclick="submitRating(1)">üëç </button>
                <button class="btn " onclick="submitRating(0)">üëé </button>
            </div>
            <div id="feedbackToast" class="alert alert-success d-none" role="alert">
                Thanks for your feedback! It helps improve our model.
            </div>

            <form method="GET" action="/" class="mt-3">
                <button type="submit" class="btn btn-outline-secondary">Reset Prediction</button>
            </form>
        </div>
    {% endif %}
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
function submitRating(ratingValue) {
    fetch('/submit-rating', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded'
        },
        body: `rating=${ratingValue}`
    }).then(response => response.json())
      .then(data => {
          const toast = document.getElementById('feedbackToast');
          toast.classList.remove('d-none');
          toast.textContent = data.message;
      });
}
</script>
</body>
</html>